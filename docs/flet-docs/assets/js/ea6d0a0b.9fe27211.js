"use strict";(self.webpackChunkflet_dev=self.webpackChunkflet_dev||[]).push([[47248],{27398:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>t});var d=i(74848),s=i(28453);const o={title:"Packaging app for Android",sidebar_label:"Android"},r=void 0,l={id:"publish/android",title:"Packaging app for Android",description:"Introduction",source:"@site/docs/publish/android.md",sourceDirName:"publish",slug:"/publish/android",permalink:"/flet-docs/docs/publish/android",draft:!1,unlisted:!1,editUrl:"https://github.com/flet-dev/website/edit/main/docs/publish/android.md",tags:[],version:"current",frontMatter:{title:"Packaging app for Android",sidebar_label:"Android"},sidebar:"docs",previous:{title:"Publishing Flet app to multiple platforms",permalink:"/flet-docs/docs/publish"},next:{title:"iOS",permalink:"/flet-docs/docs/publish/ios"}},a={},t=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Android SDK",id:"android-sdk",level:3},{value:"Android wheels for binary Python packages",id:"android-wheels-for-binary-python-packages",level:3},{value:"<code>flet build apk</code>",id:"flet-build-apk",level:2},{value:"Building platform-specific APKs",id:"building-platform-specific-apks",level:3},{value:"Installing APK to a device",id:"installing-apk-to-a-device",level:3},{value:"<code>flet build aab</code>",id:"flet-build-aab",level:2},{value:"Signing Android bundle",id:"signing-android-bundle",level:2},{value:"Splash screen",id:"splash-screen",level:2},{value:"Permissions",id:"permissions",level:2},{value:"Meta-data",id:"meta-data",level:2},{value:"Deep linking",id:"deep-linking",level:2},{value:"Troubleshooting Android",id:"troubleshooting-android",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,d.jsxs)(n.p,{children:["Flet CLI provides ",(0,d.jsx)(n.code,{children:"flet build apk"})," and ",(0,d.jsx)(n.code,{children:"flet build aab"})," commands that allow packaging Flet app into Android APK and Android App Bundle (AAB) respectively."]}),"\n",(0,d.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,d.jsx)(n.h3,{id:"android-sdk",children:"Android SDK"}),"\n",(0,d.jsxs)(n.p,{children:["Java (JDK) and Android SDK will be automatically installed on the first run of ",(0,d.jsx)(n.code,{children:"flet build"})," command."]}),"\n",(0,d.jsxs)(n.p,{children:["JDK is installed into ",(0,d.jsx)(n.code,{children:"$HOME/java/{version}"})," directory."]}),"\n",(0,d.jsxs)(n.p,{children:["If you have Android Studio installed Flet CLI will locate and use Android SDK coming with the studio; otherwise Android SDK will be installed to ",(0,d.jsx)(n.code,{children:"$HOME/Android/sdk"})," directory."]}),"\n",(0,d.jsx)(n.h3,{id:"android-wheels-for-binary-python-packages",children:"Android wheels for binary Python packages"}),"\n",(0,d.jsxs)(n.p,{children:['Binary Python packages (vs "pure" Python packages written in Python only) are packages that partially written in C, Rust or other languages producing native code. Example packages are ',(0,d.jsx)(n.code,{children:"numpy"}),", ",(0,d.jsx)(n.code,{children:"cryptography"}),", or ",(0,d.jsx)(n.code,{children:"pydantic-core"}),"."]}),"\n",(0,d.jsxs)(n.p,{children:["Make sure all non-pure (binary) packages used in your Flet app have ",(0,d.jsx)(n.a,{href:"/docs/reference/binary-packages-android-ios",children:"pre-built wheels for Android"}),"."]}),"\n",(0,d.jsx)(n.h2,{id:"flet-build-apk",children:(0,d.jsx)(n.code,{children:"flet build apk"})}),"\n",(0,d.jsx)(n.p,{children:"Build an Android APK file from your app."}),"\n",(0,d.jsx)(n.p,{children:"This command builds release version. 'release' builds don't support debugging and are suitable for deploying to app stores. If you are deploying the app to the Play Store, it's recommended to use Android App Bundles (AAB) or split the APK to reduce the APK size."}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://developer.android.com/guide/app-bundle",children:"https://developer.android.com/guide/app-bundle"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://developer.android.com/studio/build/configure-apk-splits#configure-abi-split",children:"https://developer.android.com/studio/build/configure-apk-splits#configure-abi-split"})}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"building-platform-specific-apks",children:"Building platform-specific APKs"}),"\n",(0,d.jsxs)(n.p,{children:['By default, Flet builds "fat" APK which includes binaries for both ',(0,d.jsx)(n.code,{children:"arm64-v8a"})," and ",(0,d.jsx)(n.code,{children:"armeabi-v7a"})," architectures."]}),"\n",(0,d.jsxs)(n.p,{children:["You can configure Flet to split fat APK into smaller APKs for each platformby using ",(0,d.jsx)(n.code,{children:"--split-per-abi"})," option or by setting ",(0,d.jsx)(n.code,{children:"split_per_abi"})," in ",(0,d.jsx)(n.code,{children:"pyproject.toml"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:"[tool.flet.android]\nsplit_per_abi = true\n"})}),"\n",(0,d.jsx)(n.h3,{id:"installing-apk-to-a-device",children:"Installing APK to a device"}),"\n",(0,d.jsxs)(n.p,{children:["The easiest way to install APK to your device is to use ",(0,d.jsx)(n.code,{children:"adb"})," (Android Debug Bridge) tool."]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"adb"})," is a part of Android SDK. For example, on macOS, if Android SDK was installed with Android Studio\nthe location of ",(0,d.jsx)(n.code,{children:"adb"})," tool will be at ",(0,d.jsx)(n.code,{children:"~/Library/Android/sdk/platform-tools/adb"}),"."]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.a,{href:"https://www.makeuseof.com/install-apps-via-adb-android/",children:"Check this article"})," for more information about installing and using ",(0,d.jsx)(n.code,{children:"adb"})," tool on various platforms."]}),"\n",(0,d.jsx)(n.p,{children:"To install APK to a device run the following command:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"adb install <path-to-your.apk>\n"})}),"\n",(0,d.jsxs)(n.p,{children:["If more than one device is connected to your computer (say, emulator and a physical phone) you can\nuse ",(0,d.jsx)(n.code,{children:"-s"})," option to specify which device you want to install ",(0,d.jsx)(n.code,{children:".apk"})," on:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"adb -s <device> install <path-to-your.apk>\n"})}),"\n",(0,d.jsxs)(n.p,{children:["where ",(0,d.jsx)(n.code,{children:"<device>"})," can be found with ",(0,d.jsx)(n.code,{children:"adb devices"})," command."]}),"\n",(0,d.jsx)(n.h2,{id:"flet-build-aab",children:(0,d.jsx)(n.code,{children:"flet build aab"})}),"\n",(0,d.jsx)(n.p,{children:"Build an Android App Bundle (AAB) file from your app."}),"\n",(0,d.jsx)(n.p,{children:"This command builds release version. 'release' builds don't support debugging and are suitable for deploying to app stores. App bundle is the recommended way to publish to the Play Store as it improves your app size."}),"\n",(0,d.jsx)(n.h2,{id:"signing-android-bundle",children:"Signing Android bundle"}),"\n",(0,d.jsx)(n.p,{children:"TBD"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:'[tool.flet.android.signing]\n# store and key passwords can be passed with `--android-signing-key-store-password`\n# and `--android-signing-key-password` options or\n# FLET_ANDROID_SIGNING_KEY_STORE_PASSWORD\n# and FLET_ANDROID_SIGNING_KEY_PASSWORD environment variables.\nkey_store = "path/to/store.jks" # --android-signing-key-store\nkey_alias = "upload"\n'})}),"\n",(0,d.jsx)(n.h2,{id:"splash-screen",children:"Splash screen"}),"\n",(0,d.jsxs)(n.p,{children:["By default, generated Android app will be showing a splash screen with an image from ",(0,d.jsx)(n.code,{children:"assets"})," directory (see below) or Flet logo. You can disable splash screen for Android app with ",(0,d.jsx)(n.code,{children:"--no-android-splash"})," option."]}),"\n",(0,d.jsxs)(n.p,{children:["Configuring splash in ",(0,d.jsx)(n.code,{children:"pyproject.toml"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:"[tool.flet.splash]\nandroid = false\n"})}),"\n",(0,d.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,d.jsxs)(n.p,{children:["Configuring Android permissions and features to be written into ",(0,d.jsx)(n.code,{children:"AndroidManifest.xml"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"flet build --android-permissions permission=True|False ... --android-features feature_name=True|False\n"})}),"\n",(0,d.jsx)(n.p,{children:"For example:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"flet build \\\n    --android-permissions android.permission.READ_EXTERNAL_STORAGE=True \\\n      android.permission.WRITE_EXTERNAL_STORAGE=True \\\n    --android-features android.hardware.location.network=False\n"})}),"\n",(0,d.jsx)(n.p,{children:"Default Android permissions:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"android.permission.INTERNET"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Default permissions can be disabled with ",(0,d.jsx)(n.code,{children:"--android-permissions"})," option and ",(0,d.jsx)(n.code,{children:"False"})," value, for example:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"flet build --android-permissions android.permission.INTERNET=False\n"})}),"\n",(0,d.jsx)(n.p,{children:"Default Android features:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"android.software.leanback=False"})," (",(0,d.jsx)(n.code,{children:"False"})," means it's written in manifest as ",(0,d.jsx)(n.code,{children:'android:required="false"'}),")"]}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"android.hardware.touchscreen=False"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Configuring permissions and features in ",(0,d.jsx)(n.code,{children:"pyproject.toml"})," (notice quotes ",(0,d.jsx)(n.code,{children:'"'})," around key names):"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:'[tool.flet.android.permission] # --android-permissions\n"android.permission.CAMERA" = true\n"android.permission.CAMERA" = true\n\n[tool.flet.android.feature] # --android-features\n"android.hardware.camera" = false\n'})}),"\n",(0,d.jsx)(n.h2,{id:"meta-data",children:"Meta-data"}),"\n",(0,d.jsxs)(n.p,{children:["Configuring Android app meta-data to be written into ",(0,d.jsx)(n.code,{children:"AndroidManifest.xml"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"flet build --android-meta-data name_1=value_1 name_2=value_2 ...\n"})}),"\n",(0,d.jsx)(n.p,{children:"Default Android meta-data:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"io.flutter.embedding.android.EnableImpeller=false"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["Configuring meta-data in ",(0,d.jsx)(n.code,{children:"pyproject.toml"})," (notice quotes ",(0,d.jsx)(n.code,{children:'"'})," around key names):"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:'[tool.flet.android.meta_data]\n"com.google.android.gms.ads.APPLICATION_ID" = "ca-app-pub-xxxxxxxxxxxxxxxx~yyyyyyyyyy"\n'})}),"\n",(0,d.jsx)(n.h2,{id:"deep-linking",children:"Deep linking"}),"\n",(0,d.jsxs)(n.p,{children:["You can configure deep-linking settings for Android app with the following ",(0,d.jsx)(n.code,{children:"flet build"})," options:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"--deep-linking-scheme"}),' - deep linking URL scheme to configure for Android builds, i.g. "https" or "myapp".']}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"--deep-linking-host"})," - deep linking URL host."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["The same can be configured in ",(0,d.jsx)(n.code,{children:"pyproject.toml"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-toml",children:'[tool.flet.android.deep_linking]\nscheme = "https"\nhost = "mydomain.com"\n'})}),"\n",(0,d.jsxs)(n.p,{children:["See ",(0,d.jsx)(n.a,{href:"https://docs.flutter.dev/ui/navigation/deep-linking",children:"Deep linking"})," section in Flutter docs for more information and complete setup guide."]}),"\n",(0,d.jsx)(n.h2,{id:"troubleshooting-android",children:"Troubleshooting Android"}),"\n",(0,d.jsx)(n.p,{children:"To run interactive commands inside simulator or device:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"adb shell\n"})}),"\n",(0,d.jsx)(n.p,{children:'To overcome "permissions denied" error while trying to browse file system in interactive Android shell:'}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"su\n"})}),"\n",(0,d.jsx)(n.p,{children:"To download a file from a device to your local computer:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"adb pull <device-path> <local-path>\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var d=i(96540);const s={},o=d.createContext(s);function r(e){const n=d.useContext(o);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),d.createElement(o.Provider,{value:n},e.children)}}}]);