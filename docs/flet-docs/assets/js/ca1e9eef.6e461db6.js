"use strict";(self.webpackChunkflet_dev=self.webpackChunkflet_dev||[]).push([[7150],{40480:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(74848),o=n(28453);const i={slug:"navigation-and-routing",title:"Navigation and Routing",author:"Feodor Fitsner",author_title:"Flet founder and developer",author_url:"https://github.com/FeodorFitsner",author_image_url:"https://avatars0.githubusercontent.com/u/5041459?s=400&v=4",tags:["release"]},r=void 0,s={permalink:"/docs/flet-docs/blog/navigation-and-routing",editUrl:"https://github.com/flet-dev/website/edit/main/blog/2022-07-23-navigation-and-routing.md",source:"@site/blog/2022-07-23-navigation-and-routing.md",title:"Navigation and Routing",description:"Flet 0.1.42 has been released with navigation and routing!",date:"2022-07-23T00:00:00.000Z",tags:[{inline:!0,label:"release",permalink:"/docs/flet-docs/blog/tags/release"}],readingTime:4.025,hasTruncateMarker:!1,authors:[{name:"Feodor Fitsner",title:"Flet founder and developer",url:"https://github.com/FeodorFitsner",imageURL:"https://avatars0.githubusercontent.com/u/5041459?s=400&v=4"}],frontMatter:{slug:"navigation-and-routing",title:"Navigation and Routing",author:"Feodor Fitsner",author_title:"Flet founder and developer",author_url:"https://github.com/FeodorFitsner",author_image_url:"https://avatars0.githubusercontent.com/u/5041459?s=400&v=4",tags:["release"]},unlisted:!1,prevItem:{title:"Flet Mobile Strategy",permalink:"/docs/flet-docs/blog/flet-mobile-strategy"},nextItem:{title:"New release: Drag and Drop, absolute positioning and clickable container",permalink:"/docs/flet-docs/blog/drag-and-drop-release"}},l={authorsImageUrls:[void 0]},c=[{value:"Page route",id:"page-route",level:2},{value:"Page views",id:"page-views",level:2},{value:"Building views on route change",id:"building-views-on-route-change",level:2},{value:"Route templates",id:"route-templates",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"https://pypi.org/project/flet/0.1.42/",children:"Flet 0.1.42"})," has been released with navigation and routing!"]}),"\n",(0,a.jsx)(t.p,{children:'Navigation and routing is an essential feature of Single Page Applications (SPA) which allows organizing application user interface into virtual pages (views) and "navigate" between them while application URL reflects the current state of the app.'}),"\n",(0,a.jsxs)(t.p,{children:["For mobile apps navigation and routing serves as a ",(0,a.jsx)(t.a,{href:"https://docs.flutter.dev/development/ui/navigation/deep-linking",children:"deep linking"})," to specific application parts."]}),"\n",(0,a.jsxs)(t.p,{children:["Well, it took ",(0,a.jsx)(t.a,{href:"https://github.com/flet-dev/flet/pull/95/files",children:"more efforts"})," than expected to add navigation and routing into Flet as the implementation is based on ",(0,a.jsx)(t.a,{href:"https://medium.com/flutter/learning-flutters-new-navigation-and-routing-system-7c9068155ade",children:"Navigator 2.0"}),' Flutter API and required to replace Flet\'s "Page" abstraction with "Page and Views". Flutter\'s newer navigation and routing API has substantial improvements such as:']}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Programmatic control over history stack."}),"\n",(0,a.jsx)(t.li,{children:'An easy way to intercept a call to "Back" button in AppBar.'}),"\n",(0,a.jsx)(t.li,{children:"Robust synchronization with browser history."}),"\n"]}),"\n",(0,a.jsx)("img",{src:"/img/docs/navigation-routing/routing-app-example.gif",className:"screenshot-60"}),"\n",(0,a.jsxs)(t.p,{children:["Explore ",(0,a.jsx)(t.a,{href:"https://github.com/flet-dev/examples/blob/main/python/apps/routing-navigation/building-views-on-route-change.py",children:"source code"})," of the example above."]}),"\n",(0,a.jsx)(t.h2,{id:"page-route",children:"Page route"}),"\n",(0,a.jsxs)(t.p,{children:["Page route is a portion of application URL after ",(0,a.jsx)(t.code,{children:"#"})," symbol:"]}),"\n",(0,a.jsx)("img",{src:"/img/docs/navigation-routing/page-address-route.png",className:"screenshot-50"}),"\n",(0,a.jsxs)(t.p,{children:["Default application route, if not set in application URL by the user, is ",(0,a.jsx)(t.code,{children:"/"}),". All routes start with ",(0,a.jsx)(t.code,{children:"/"}),", for example ",(0,a.jsx)(t.code,{children:"/store"}),", ",(0,a.jsx)(t.code,{children:"/authors/1/books/2"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Application route can be obtained by reading ",(0,a.jsx)(t.code,{children:"page.route"})," property, for example:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import flet as ft\n\ndef main(page: ft.Page):\n    page.add(ft.Text(f"Initial route: {page.route}"))\n\nft.app(target=main, view=ft.AppView.WEB_BROWSER)\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Grab application URL, open a new browser tab, paste the URL, modify its part after ",(0,a.jsx)(t.code,{children:"#"})," to ",(0,a.jsx)(t.code,{children:"/test"}),' and hit enter. You should see "Initial route: /test".']}),"\n",(0,a.jsxs)(t.p,{children:["Every time the route in the URL is changed (by editing the URL or navigating browser history with Back/Forward buttons) Flet calls ",(0,a.jsx)(t.code,{children:"page.on_route_change"})," event handler:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import flet as ft\n\ndef main(page: ft.Page):\n    page.add(ft.Text(f"Initial route: {page.route}"))\n\n    def route_change(route):\n        page.add(ft.Text(f"New route: {route}"))\n\n    page.on_route_change = route_change\n    page.update()\n\nft.app(target=main, view=ft.AppView.WEB_BROWSER)\n'})}),"\n",(0,a.jsx)(t.p,{children:"Now try updating URL hash a few times and then use Back/Forward buttons! You should see a new message added to a page each time the route changes:"}),"\n",(0,a.jsx)("img",{src:"/img/docs/navigation-routing/page-route-change-event.gif",className:"screenshot-60"}),"\n",(0,a.jsxs)(t.p,{children:["Route can be changed programmatically, by updating ",(0,a.jsx)(t.code,{children:"page.route"})," property:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import flet as ft\n\ndef main(page: ft.Page):\n    page.add(ft.Text(f"Initial route: {page.route}"))\n\n    def route_change(route):\n        page.add(ft.Text(f"New route: {route}"))\n\n    def go_store(e):\n        page.route = "/store"\n        page.update()\n\n    page.on_route_change = route_change\n    page.add(ft.ElevatedButton("Go to Store", on_click=go_store))\n\nft.app(target=main, view=ft.AppView.WEB_BROWSER)\n'})}),"\n",(0,a.jsx)(t.p,{children:'Click "Go to Store" button and you\'ll see application URL is changed and a new item is pushed in a browser history. You can use browser "Back" button to navigate to a previous route.'}),"\n",(0,a.jsx)(t.h2,{id:"page-views",children:"Page views"}),"\n",(0,a.jsxs)(t.p,{children:["Flet's ",(0,a.jsx)(t.a,{href:"/docs/controls/page",children:"Page"})," now is not just a single page, but a container for ",(0,a.jsx)(t.a,{href:"/docs/controls/view",children:"View"})," layered on top of each other like a sandwich:"]}),"\n",(0,a.jsx)("img",{src:"/img/docs/navigation-routing/page-views.svg",className:"screenshot-100"}),"\n",(0,a.jsxs)(t.p,{children:["A collection of views represents navigator history. Page has ",(0,a.jsx)(t.a,{href:"/docs/controls/page#views",children:(0,a.jsx)(t.code,{children:"page.views"})})," property to access views collection."]}),"\n",(0,a.jsx)(t.p,{children:"The last view in the list is the one currently displayed on a page. Views list must have at least one element (root view)."}),"\n",(0,a.jsxs)(t.p,{children:["To simulate a transition between pages change ",(0,a.jsx)(t.code,{children:"page.route"})," and add a new ",(0,a.jsx)(t.code,{children:"View"})," in the end of ",(0,a.jsx)(t.code,{children:"page.view"})," list."]}),"\n",(0,a.jsxs)(t.p,{children:['Pop the last view from the collection and change route to a "previous" one in ',(0,a.jsx)(t.a,{href:"/docs/controls/page#on_view_pop",children:(0,a.jsx)(t.code,{children:"page.on_view_pop"})})," event handler to go back."]}),"\n",(0,a.jsx)(t.h2,{id:"building-views-on-route-change",children:"Building views on route change"}),"\n",(0,a.jsx)(t.p,{children:"To build a reliable navigation there must be a single place in the program which builds a list of views depending on the current route. Other words, navigation history stack (represented by the list of views) must be a function of a route."}),"\n",(0,a.jsxs)(t.p,{children:["This place is ",(0,a.jsx)(t.a,{href:"/docs/controls/page#on_route_change",children:(0,a.jsx)(t.code,{children:"page.on_route_change"})})," event handler."]}),"\n",(0,a.jsx)(t.p,{children:"Let's put everything together into a complete example which allows navigating between two pages:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import flet as ft\n\ndef main(page: ft.Page):\n    page.title = "Routes Example"\n\n    def route_change(route):\n        page.views.clear()\n        page.views.append(\n            ft.View(\n                "/",\n                [\n                    ft.AppBar(title=ft.Text("Flet app"), bgcolor=ft.Colors.SURFACE_VARIANT),\n                    ft.ElevatedButton("Visit Store", on_click=lambda _: page.go("/store")),\n                ],\n            )\n        )\n        if page.route == "/store":\n            page.views.append(\n                ft.View(\n                    "/store",\n                    [\n                        ft.AppBar(title=ft.Text("Store"), bgcolor=ft.Colors.SURFACE_VARIANT),\n                        ft.ElevatedButton("Go Home", on_click=lambda _: page.go("/")),\n                    ],\n                )\n            )\n        page.update()\n\n    def view_pop(view):\n        page.views.pop()\n        top_view = page.views[-1]\n        page.go(top_view.route)\n\n    page.on_route_change = route_change\n    page.on_view_pop = view_pop\n    page.go(page.route)\n\n\nft.app(target=main, view=ft.AppView.WEB_BROWSER)\n'})}),"\n",(0,a.jsx)(t.p,{children:'Try navigating between pages using "Visit Store" and "Go Home" buttons, Back/Forward browser buttons, manually changing route in the URL - it works no matter what! :)'}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:['To "navigate" between pages we used ',(0,a.jsx)(t.a,{href:"/docs/controls/page#goroute",children:(0,a.jsx)(t.code,{children:"page.go(route)"})})," - a helper method that updates ",(0,a.jsx)(t.a,{href:"/docs/controls/page#route",children:(0,a.jsx)(t.code,{children:"page.route"})}),", calls ",(0,a.jsx)(t.a,{href:"/docs/controls/page#on_route_change",children:(0,a.jsx)(t.code,{children:"page.on_route_change"})})," event handler to update views and finally calls ",(0,a.jsx)(t.code,{children:"page.update()"}),"."]})}),"\n",(0,a.jsxs)(t.p,{children:["Notice the usage of ",(0,a.jsx)(t.a,{href:"/docs/controls/page#on_view_pop",children:(0,a.jsx)(t.code,{children:"page.on_view_pop"})}),' event handler. It fires when the user clicks automatic "Back" button in ',(0,a.jsx)(t.a,{href:"/docs/controls/appbar",children:(0,a.jsx)(t.code,{children:"AppBar"})}),' control. In the handler we remove the last element from views collection and navigate to view\'s root "under" it.']}),"\n",(0,a.jsx)(t.h2,{id:"route-templates",children:"Route templates"}),"\n",(0,a.jsxs)(t.p,{children:["Flet offers ",(0,a.jsx)(t.a,{href:"https://github.com/flet-dev/flet/blob/main/sdk/python/packages/flet-core/src/flet_core/template_route.py",children:(0,a.jsx)(t.code,{children:"TemplateRoute"})})," - an utility class based on ",(0,a.jsx)(t.a,{href:"https://github.com/nickcoutsos/python-repath",children:"repath"})," library which allows matching ExpressJS-like routes and parsing their parameters, for example ",(0,a.jsx)(t.code,{children:"/account/:account_id/orders/:order_id"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"TemplateRoute"})," plays great with route change event:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'troute = TemplateRoute(page.route)\n\nif troute.match("/books/:id"):\n    print("Book view ID:", troute.id)\nelif troute.match("/account/:account_id/orders/:order_id"):\n    print("Account:", troute.account_id, "Order:", troute.order_id)\nelse:\n    print("Unknown route")\n'})}),"\n",(0,a.jsxs)(t.p,{children:["You can read more about template syntax supported by ",(0,a.jsx)(t.code,{children:"repath"})," library ",(0,a.jsx)(t.a,{href:"https://github.com/nickcoutsos/python-repath#parameters",children:"here"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"That's all for today!"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"/docs",children:"Give Flet a try"})," and ",(0,a.jsx)(t.a,{href:"https://discord.gg/dzWXP8SHG8",children:"let us know"})," what you think!"]})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var a=n(96540);const o={},i=a.createContext(o);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);